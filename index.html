<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Security Check</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">

<style>
body{
  font-family:Arial;
  background:#111;
  color:white;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  height:100vh;
}
#captcha-container{
  position:relative;
  width:300px;
  height:150px;
  border:2px solid #555;
  margin-bottom:20px;
}
#bg-image{ width:100%; height:100%; }
#puzzle{
  position:absolute;
  width:50px;
  height:50px;
  top:50px;
  left:0;
  background-size:300px 150px;
  box-shadow:0 0 8px black;
}
#slider{ width:300px; }
#message{ margin-top:15px; font-weight:bold; }
</style>

<script>
/* üîê Prevent returning after verification */
if(sessionStorage.getItem("captchaOK") === "1"){
  location.replace("app.html");
}
</script>
</head>

<body>

<h2>Slide to Verify</h2>

<div id="captcha-container">
  <img id="bg-image">
  <div id="puzzle"></div>
</div>

<input type="range" id="slider" min="0" max="250" value="0">
<div id="message"></div>

<script>
const slider = document.getElementById("slider");
const puzzle = document.getElementById("puzzle");
const msg = document.getElementById("message");

const id = Math.floor(Math.random()*800);
const img = `https://picsum.photos/id/${id}/300/150`;

document.getElementById("bg-image").src = img;
puzzle.style.backgroundImage = `url(${img})`;

const target = Math.floor(Math.random()*80)+150;
puzzle.style.backgroundPosition = `-${target}px -50px`;

slider.oninput = ()=> puzzle.style.left = slider.value+"px";

slider.onchange = ()=>{
  const v = parseInt(slider.value);
  if(Math.abs(v - target) < 10){
    msg.textContent="‚úî Verified";
    msg.style.color="lime";
    slider.disabled=true;

    sessionStorage.setItem("captchaOK","1");

    setTimeout(()=>{
      location.replace("app.html");
    },500);
  } else {
    msg.textContent="‚ùå Try again";
    msg.style.color="red";
    slider.value=0;
    puzzle.style.left="0px";
  }
}
</script>

</body>
</html>
